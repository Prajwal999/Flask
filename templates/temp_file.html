<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rose Rain for My Love üåπ</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background: linear-gradient(to bottom, #0f001a, #220033);
      font-family: 'Georgia', serif;
      color: #fff;
      cursor: pointer;
    }

    canvas {
      position: fixed;
      top: 0; left: 0;
      z-index: 1;
      pointer-events: none;
    }

    #ui {
      position: fixed;
      inset: 0;
      z-index: 10;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      pointer-events: none;
    }

    h1 {
      font-size: 4rem;
      margin: 0.5rem;
      text-shadow: 0 0 30px #ff69b4, 0 0 60px #ff1493;
      animation: pulse 5s ease-in-out infinite;
    }

    p {
      font-size: 1.9rem;
      margin: 1.5rem;
      text-shadow: 0 0 20px #ffb6c1;
    }

    #reveal {
      position: fixed;
      inset: 0;
      background: rgba(10, 0, 30, 0.94);
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 20;
      opacity: 0;
      transition: opacity 2s ease;
    }

    #reveal.show {
      display: flex;
      opacity: 1;
    }

    #her {
        width: 200vmin;
        max-width: 1500px;
        border-radius: 50%;
        border: 0px solid #ff69b4;
        box-shadow: 0 0 100px #ff69b4, 0 0 180px #ff1493;
        transform: scale(3);
        opacity: 0;
        transition: all 2.5s cubic-bezier(0.34, 1.56, 5, 1);
    }

    #message {
      font-size: 4.5rem;
      margin-top: 3rem;
      text-shadow: 0 0 50px #ff69b4;
      opacity: 0;
      transform: translateY(80px);
      transition: all 2.2s ease-out 1.2s;
    }

    #reveal.show #message {
      opacity: 1;
      transform: translateY(0);
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50%      { transform: scale(1.06); }
    }
  </style>
</head>
<body>

  <canvas id="c"></canvas>

<div style="position:fixed; left:50%; bottom:4vmin; transform:translateX(-50%); z-index:0; pointer-events:none; display:flex; justify-content:center; align-items:flex-end;">
    <img id="mini-her" src="{{ url_for('static', filename='face.png') }}" alt="Her" style="width:clamp(220px,60vmin,1200px); max-width:90vw; border-radius:50%;  display:block;" />
</div>
<audio id="bg-music" loop>
  <source src="{{ url_for('static', filename='background.mp3') }}" type="audio/mpeg">
</audio>

  <div id="reveal">
    <!-- Replace with real photo URL of her -->
    <img id="her" src="{{ url_for('static', filename='face.png') }}" alt="You ‚ô•" />
    <div id="message">You are the most beautiful rose ‚ù§Ô∏è</div>
  </div>

  <script>
  const bgMusic = document.getElementById('bg-music');
  let musicStarted = false;
  window.addEventListener('click', (e) => {
    if (!musicStarted) {
      bgMusic.volume = 0.5;
      bgMusic.play().catch(() => {});
      musicStarted = true;
    }

    pops.push({
      x: e.clientX,
      y: e.clientY,
      life: 0
    });
});


  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d');
  let cw, ch;

  function resize() {
    cw = canvas.width = window.innerWidth;
    ch = canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  /* ---------- Images ---------- */
  const petalSrcs = [
    "{{ url_for('static', filename='rose.png') }}"
  ];

  const loaded = [];
  petalSrcs.forEach(src => {
    const img = new Image();
    img.src = src;
    img.onload = () => loaded.push(img);
  });

  /* ---------- Petals ---------- */
  let petals = [];
  const maxPetals = 2500;
  const spawnPerFrame = 3;

  class Petal {
    constructor() {
      this.reset();
    }

    reset() {
      this.x = Math.random() * (cw * 2) - cw * 0.5;
      this.y = -20 - Math.random() * ch * 0.6;
      this.size = 8 + Math.random() * 50;
      this.speedY = 0.4 + Math.random() * 0.6;
      this.speedX = -0.2 + Math.random() * 0.4;
      this.rotation = Math.random() * Math.PI * 2;
      this.rotSpeed = (Math.random() - 0.5) * 0.02;
      this.img = loaded[Math.floor(Math.random() * loaded.length)] || null;
      this.opacity = 0.5 + Math.random() * 0.4;
    }

    update() {
      this.y += this.speedY;
      this.x += this.speedX;
      this.rotation += this.rotSpeed;

      if (this.y > ch + 40) this.reset();
    }

    draw() {
      if (!this.img) return;
      ctx.save();
      ctx.globalAlpha = this.opacity;
      ctx.translate(this.x, this.y);
      ctx.rotate(this.rotation);
      ctx.drawImage(
        this.img,
        -this.size / 2,
        -this.size / 2,
        this.size,
        this.size
      );
      ctx.restore();
    }
  }


  /* ---------- Love Pops ---------- */
  const pops = [];

  window.addEventListener('click', (e) => {
    pops.push({
      x: e.clientX,
      y: e.clientY,
      life: 0
    });
  });

  /* ---------- Init ---------- */
  function init() {
    for (let i = 0; i < 400; i++) {
      const p = new Petal();
      p.y = Math.random() * ch;
      petals.push(p);
    }
    animate();
  }

  /* ---------- Animate ---------- */
  function animate() {
    ctx.clearRect(0, 0, cw, ch);

    if (petals.length < maxPetals) {
      for (let i = 0; i < spawnPerFrame; i++) {
        petals.push(new Petal());
      }
    }

    petals.forEach(p => {
      p.update();
      p.draw();
    });

    // Draw love pops
    for (let i = pops.length - 1; i >= 0; i--) {
      const p = pops[i];
      p.life++;

      ctx.save();
      ctx.globalAlpha = 1 - p.life / 60;
      ctx.fillStyle = "#ffb6c1";
      ctx.font = `${8 + p.life * 0.5}px Georgia`;
      ctx.textAlign = "center";
      ctx.shadowColor = "#ff69b4";
      ctx.shadowBlur = 15;
      ctx.fillText("I love you Sammy ‚ù§Ô∏è", p.x, p.y - p.life);
      ctx.restore();

      if (p.life > 60) pops.splice(i, 1);
    }

    requestAnimationFrame(animate);
  }

  init();
</script>
</body>
</html>